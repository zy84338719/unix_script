# 跨平台自动关机脚本 (macOS & Linux)

这是一个简单而强大的 Bash 脚本，用于在 macOS 和 Linux 系统上管理临时和每日的自动关机任务。它提供了一个用户友好的交互式菜单，可以轻松设置或取消关机计划。

## ✨ 功能特性

- **跨平台兼容**: 自动检测并支持 **macOS** 和 **Linux**。
- **两种关机模式**:
  - **临时关机**: 设置一个仅在当天生效的特定关机时间。
  - **每日定时关机**: 设置一个每天在相同时间重复执行的关机任务。
- **轻松取消**: 可以随时独立地取消临时或每日关机计划。
- **交互式菜单**: 通过简单的数字选择即可完成所有操作。
- **安全的权限处理**: 所有需要管理员权限的操作都会通过 `sudo` 请求授权。
- **无外部依赖**: 仅使用系统内置命令 (`shutdown`, `launchctl`, `cron`)。

## 🚀 如何使用

1. **授予执行权限**:

   打开终端，进入脚本所在目录，然后运行以下命令：
   ```bash
   chmod +x shutdown_timer.sh
   ```

2. **运行脚本**:

   ```bash
   ./shutdown_timer.sh
   ```

3. **根据菜单操作**:

   脚本启动后，您会看到一个清晰的菜单。只需输入相应的数字并按回车即可：

   ```
   [信息] 自动关机管理菜单
   ---------------------------------
     1. 设置临时关机 (仅今天)
     2. 设置每日定时关机
     3. 取消临时关机
     4. 取消每日定时关机
     5. 退出
   ---------------------------------
   请输入选项 [1-5]:
   ```

## 🔧 技术实现

脚本通过在启动时检测操作系统 (`uname -s`) 来决定使用哪种底层技术：

| 功能 | macOS 实现 | Linux 实现 |
| :--- | :--- | :--- |
| **临时关机设置** | `sudo shutdown HH:MM` | `sudo shutdown HH:MM` |
| **临时关机取消** | `sudo killall shutdown` | `sudo shutdown -c` |
| **每日关机设置** | 创建 `launchd` 任务 (`.plist` 文件) | 在用户 `crontab` 中添加条目 |
| **每日关机取消** | 卸载并删除 `launchd` 任务 | 从用户 `crontab` 中移除条目 |

- 在 **macOS** 上，每日关机任务的配置文件位于 `/Library/LaunchDaemons/com.user.dailyshutdown.plist`。
- 在 **Linux** 上，每日关机任务会通过一个特殊的注释 `# AUTO_SHUTDOWN_SCRIPT` 标记在 `crontab` 中，以便脚本能够识别和管理它。

## ⚠️ 注意事项

- 在 Linux 系统上，请确保 `cron` 服务正在运行。
- 所有需要修改系统配置的操作都需要您输入当前用户的密码（sudo 权限）。
- 如果您手动修改了 `crontab` 或 `launchd` 的任务文件，脚本可能无法正确识别它们。
